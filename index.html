<!DOCTYPE HTML>
<html>
    <head>
        <title>Electric Field</title>
        <link rel="icon" href="/favicon.ico" type="image/x-icon">
        <link rel="stylesheet" href="./libraries/all.css">
        <script src="./libraries/all.js"></script>
    </head>
    
    <body>
        <h1>Electric Field Simulation</h1>
        <label>Choose a charge configuration:</label>
        <select id="select"></select>
        <br>
        <br>
        <textarea id="input" rows="10" cols="80" autocorrect="off" autocapitalize="off" spellcheck="false"></textarea>
        <br>
        <br>
        <button id="button" type="button"><i id="spinner" class="fas fa-sync-alt" style="animation-play-state: paused;"></i> Submit</button>
        <br>
        <br>
        <img id="image" style="display: none;">
        <div class="information">
            <h1><mark class="highlight">Definitions</mark></h1>
                <h2 class="tab1">Input: Contains the data that is inputted into the simulation</h2>
                    <h3 class="tab2">Charges: A list containing data for each electric charge<br></h3>
                        <p class="tab3">
                            <mark class="parameter">Type</mark>: Charge type<br>
                            <mark class="parameter">Charge</mark>: Charge value in coulombs<br><br>
                            If charge type is set to "Point Charge", these parameters will be used<br>
                            <mark class="parameter">Position</mark>: X and Y coordinates in meters of the point charge<br><br>
                            If charge type is set to "Line Charge", these parameters will be used<br>
                            <mark class="parameter">Endpoint1</mark>: X and Y coordinates in meters of the first endpoint<br>
                            <mark class="parameter">Endpoint2</mark>: X and Y coordinates in meters of the second endpoint
                        </p>
                    <h3 class="tab2">Flashlights: A list containing data for each flashlight that defines the starting position of the field lines</h3>
                        <p class="tab3">
                            <mark class="parameter">Type</mark>: Shape type of flashlight<br>
                            <mark class="parameter">Number of Field Lines</mark>: The number of electric field lines simulated with the flashlight<br><br>
                            If flashlight type is set to "Line Segment", these parameters will be used<br>
                            <mark class="parameter">Endpoint1</mark>: X and Y coordinates in meters of the first endpoint<br>
                            <mark class="parameter">Endpoint2</mark>: X and Y coordinates in meters of the second endpoint<br><br>
                            If flashlight type is set to "Circle", these parameters will be used<br>
                            <mark class="parameter">Position</mark>: X and Y coordinates in meters of the center of the circle<br>
                            <mark class="parameter">Radius</mark>: The radius of the circle<br><br>
                            If flashlight type is set to "Circular Arc", these parameters will be used<br>
                            <mark class="parameter">Position</mark>: X and Y coordinates in meters of the center of the arc<br>
                            <mark class="parameter">Radius</mark>: The radius in meters of the arc<br>
                            <mark class="parameter">Starting Angle</mark>: The starting angle of the arc in degrees<br>
                            <mark class="parameter">Ending Angle</mark>: The ending angle of the arc in degrees
                        </p>
                <h2 class="tab1">Output: Contains the data that is used for displaying the result</h2>
                <p class="tab2">
                    <mark class="parameter">Maximum Iterations Per Field Line</mark>: The maximum number of calculations for each field line to reduce unnecessary computation<br>
                    <mark class="parameter">Step Per Iteration</mark>: The step traveled by each field line before and after every calculation<br>
                    <mark class="parameter">MinimumX</mark>: The minimum x-value in meters that is displayed by the viewport<br>
                    <mark class="parameter">MinimumY</mark>: The minimum y-value in meters that is displayed by the viewport<br>
                    <mark class="parameter">MaximumX</mark>: The maximum x-value in meters that is displayed by the viewport<br>
                    <mark class="parameter">MaximumY</mark>: The maximum y-value in meters that is displayed by the viewport
                </p>
            <h1><mark class="highlight">Units</mark></h1>
                <h3 class="tab1">
                    Charges: <mark class="parameter">Coulombs (C)<br></mark>
                    Electric Fields: <mark class="parameter">Newtons / Coulomb (N/C)<br></mark>
                    Distances, Coordinates: <mark class="parameter">meters (m)</mark>
                </h3>
            <h1><mark class="highlight">Rules</mark></h1>
                <h3 class="tab1">
                    Number of charges is less than or equal to <mark class="parameter">100</mark><br>
                    Number of flashlights is less than or equal to <mark class="parameter">100</mark><br>
                    Total Number of Field Lines &#215; Maximum Iterations Per Field Line &#215; Number of Charges is less than or equal to <mark class="parameter">1,000,000</mark>
                </h3>
        </div>
        
        <style>
        
            *
            {
                color: white;
            }
            
            .tab1
            {
                margin-left: 40px;
            }
            
            .tab2
            {
                margin-left: 80px;
            }
            
            .tab3
            {
                margin-left: 120px;
            }
            
            body
            {
                background-color: black;
            }
            
            #select, #input, #button
            {
                background-color: #292a32;
                border: none;
                outline: none;
            }
            
            #input
            {
                font-family: "Roboto Monoto";
                padding: 5px;
            }
            
            #button
            {
                font-family: "Noto Sans";
                cursor: pointer;
                border-radius: 5px;
                padding: 10px;
                transform: perspective(1px) translateZ(0);
                transition: transform 0.3s;
            }
            
            #button:hover
            {
                background-image: linear-gradient(225deg, #f25d52, #f2b450);
                box-shadow: 0 5px 15px #7d3b13;
                transform: scale(1.05);
            }
            
            #spinner
            {
                animation: spin 2s linear infinite;
            }
            
            @keyframes spin
            {
              0% { transform: rotate(0deg); }
              100% { transform: rotate(360deg); }
            }
            
            #image
            {
                width: 1000px;
                border-style: double;
                border-width: 20px;
                border-color: #ffffff;
            }
            
            .information
            {
                font-family: "Noto Sans";
            }
            
            .highlight
            {
                color: black;
                background: #ffa040;
            }
            
            .parameter
            {
                color: #ffa040;
                background: none;
            }
            
            @font-face
            {
                font-family: "Roboto Monoto";
                src: url("./fonts/Roboto Monoto/RobotoMono-Regular.ttf") format("truetype");
            }
            
            @font-face
            {
                font-family: "Noto Sans";
                src: url("./fonts/Noto Sans/NotoSans-Regular.ttf") format("truetype");
            }
            
        </style>
        
        <script>
            
            var select = document.getElementById("select");
            var input = document.getElementById("input");
            var button = document.getElementById("button");
            var image = document.getElementById("image");
            var waiting = false;
            
            button.onclick = getImage;
            getExamples();
            
            function getImage()
            {
                if(waiting === false)
                {
                    waiting = true;
                    document.getElementById("spinner").style.animationPlayState = "running";
                    var xhttp = new XMLHttpRequest();
                    xhttp.onreadystatechange = function()
                    {
                        if(this.readyState == 4 && this.status == 200)
                        {
                            waiting = false;
                            document.getElementById("spinner").style.animationPlayState = "paused";
                            
                            if(this.responseText.length > 0)
                            {
                                image.src = "data:image/png;base64, " + this.responseText;
                                image.removeAttribute("style");
                            }
                            
                            else
                            {
                                image.removeAttribute("src");
                                image.style.display = "none";
                            }
                        }
                    };
                    xhttp.open("POST", "./scripts/server.php", true);
                    xhttp.send(input.value);
                }
            }
            
            function getExamples()
            {
                var xhttp = new XMLHttpRequest();
                xhttp.onreadystatechange = function()
                {
                    if(this.readyState == 4 && this.status == 200)
                    {
                        var examples = JSON.parse(this.responseText);
                        
                        for(var nameOfExample in examples)
                        {
                            if(Object.prototype.hasOwnProperty.call(examples, nameOfExample))
                            {
                                var example = examples[nameOfExample];
                                var option = document.createElement("option");
                                option.value = nameOfExample;
                                option.innerHTML = nameOfExample;
                                select.appendChild(option);
                            }
                        }
                        
                        select.value = "";
                        select.onchange = function()
                        {
                            input.value = JSON.stringify(examples[select.value], null, 2);
                        }
                        
                        input.onchange = function()
                        {
                            select.value = "";
                        }
                    }
                };
                xhttp.open("GET", "./scripts/examples.php", true);
                xhttp.send();
            }
        
        </script>
    </body>
</html>